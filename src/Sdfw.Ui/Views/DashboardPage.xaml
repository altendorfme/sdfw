<Page
    x:Class="Sdfw.Ui.Views.DashboardPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
    xmlns:vm="clr-namespace:Sdfw.Ui.ViewModels"
    xmlns:loc="clr-namespace:Sdfw.Ui.Localization"
    d:DataContext="{d:DesignInstance vm:DashboardViewModel}"
    mc:Ignorable="d"
    Loaded="OnLoaded">

    <Grid Margin="24">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <!-- Status Card -->
        <ui:Card Grid.Row="0" Margin="0,0,0,16">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <!-- Status Indicator -->
                <Grid Grid.Column="0" Margin="0,0,24,0">
                    <Ellipse
                        Width="64"
                        Height="64"
                        Fill="{Binding StatusColor}" />
                    <ui:SymbolIcon
                        Symbol="Shield24"
                        FontSize="32"
                        Foreground="White"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center" />
                </Grid>

                <!-- Status Info -->
                <StackPanel Grid.Column="1" VerticalAlignment="Center">
                    <TextBlock
                        Text="{Binding StatusText}"
                        FontSize="24"
                        FontWeight="SemiBold" />
                    <TextBlock
                        Text="{Binding ProviderDisplayText}"
                        Foreground="{DynamicResource TextFillColorSecondaryBrush}"
                        Margin="0,4,0,0" />
                    <TextBlock
                        Text="{Binding DefaultProviderDisplayText}"
                        Foreground="{DynamicResource TextFillColorTertiaryBrush}"
                        FontSize="12"
                        Margin="0,2,0,0"
                        Visibility="{Binding IsTemporaryConnection, Converter={StaticResource BoolToVisibilityConverter}}" />
                </StackPanel>

                <!-- Action Buttons -->
                <StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Center">
                    <ui:Button
                        Content="{loc:Localize Dashboard_Enable}"
                        Appearance="Primary"
                        Icon="{ui:SymbolIcon Play24}"
                        Command="{Binding EnableCommand}"
                        Visibility="{Binding IsEnabled, Converter={StaticResource InverseBoolToVisibilityConverter}}"
                        Margin="0,0,8,0" />
                    <ui:Button
                        Content="{loc:Localize Dashboard_Disable}"
                        Appearance="Secondary"
                        Icon="{ui:SymbolIcon Pause24}"
                        Command="{Binding DisableCommand}"
                        Visibility="{Binding IsEnabled, Converter={StaticResource BoolToVisibilityConverter}}"
                        Margin="0,0,8,0" />
                    <ui:Button
                        Content="{loc:Localize Dashboard_Revert}"
                        Appearance="Secondary"
                        Icon="{ui:SymbolIcon ArrowUndo24}"
                        Command="{Binding RevertToDefaultCommand}"
                        Visibility="{Binding IsTemporaryConnection, Converter={StaticResource BoolToVisibilityConverter}}"
                        ToolTip="{loc:Localize Dashboard_RevertToDefault}" />
                </StackPanel>
            </Grid>
        </ui:Card>

        <!-- Quick Actions -->
        <ui:Card Grid.Row="1">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>

                <ui:Button
                    Grid.Column="0"
                    Content="{loc:Localize Dashboard_FlushDnsCache}"
                    Icon="{ui:SymbolIcon Delete24}"
                    Command="{Binding FlushDnsCacheCommand}"
                    HorizontalAlignment="Stretch"
                    Margin="0,0,8,0" />

                <ui:Button
                    Grid.Column="1"
                    Content="{loc:Localize Dashboard_RefreshStatus}"
                    Icon="{ui:SymbolIcon ArrowSync24}"
                    Command="{Binding RefreshCommand}"
                    HorizontalAlignment="Stretch"
                    Margin="8,0,8,0" />

                <ui:Button
                    Grid.Column="2"
                    Content="DNS Check"
                    Icon="{ui:SymbolIcon Globe24}"
                    Click="OnDnsCheckClick"
                    HorizontalAlignment="Stretch"
                    Margin="8,0,0,0"
                    ToolTip="https://dnscheck.tools/" />
            </Grid>
        </ui:Card>

        <!-- Loading Overlay -->
        <ui:ProgressRing
            Grid.RowSpan="3"
            IsIndeterminate="True"
            Visibility="{Binding IsLoading, Converter={StaticResource BoolToVisibilityConverter}}" />
    </Grid>
</Page>
